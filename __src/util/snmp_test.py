# -*- coding: utf-8 -*-'''Created on 2012-9-9@author: zongzong'''# Notification Originator Application (TRAP)from pysnmp.carrier.asynsock.dispatch import AsynsockDispatcherfrom pysnmp.carrier.asynsock.dgram import udpfrom pyasn1.codec.ber import encoderfrom pysnmp.proto import api  from pysnmp.entity.rfc3413.oneliner import cmdgen  from pysnmp.proto import rfc1902from pysnmp.proto.rfc1902 import Gauge32 #/**#Speed   (1, 3, 6, 1, 2, 1, 2, 2, 1, 5)#*/def getIfSpeed(ip, securityName, commName):    oids = {    'load' : (1,3,6,1,4,1,2021,10,1,3,1),    'memory_total' : (1,3,6,1,4,1,2021,4,5,0),    'memory_free' : (1,3,6,1,4,1,2021,4,6,0),    'memory_buffered' : (1,3,6,1,4,1,2021,4,14,0),    'memory_cached' : (1,3,6,1,4,1,2021,4,15,0),    'cpu_idle' : (1,3,6,1,4,1,2021,11,11,0),    }        for oid in oids:        errorIndication, errorStatus, errorIndex, varBinds = cmdgen.CommandGenerator().getCmd(        cmdgen.CommunityData(securityName, commName , 1),        cmdgen.UdpTransportTarget((ip, 161)),oid,                    (('SNMPv2-MIB', 'sysObjectID'), 0))    #                         for varBind in varBinds:             print (varBind)    #     cmdgen.CommunityData('orochi', COMM_KEY),#                cmdgen.UdpTransportTarget((domain, 161)),#                oid,#                (('SNMPv2-MIB', 'sysObjectID'), 0)            #    cmdgen.UdpTransportTarget((ip, 161)),'ifSpeed')    #    cmdgen.UdpTransportTarget((ip, 161)),(1,3,6,1,4,1))#,192,168,11,118#    cmdgen.UdpTransportTarget((ip, 161)),cmdgen.MibVariable('SNMPv2-MIB', 'sysName',0))    #无用 (1.3.6.1.2.1.2.2.1.5)#    (1, 3, 6, 1, 2, 1, 2, 2, 1, 5, 22) #    if errorStatus:#        print '%s at %s\n' % (errorStatus.prettyPrint(), errorIndex and varBinds[-1][int(errorIndex) - 1] or '?')    #    print(errorIndication)#    print(errorStatus)#    print(varBinds)#def updateIfSpeed(ip, securityName, commName):  #    cg = cmdgen.CommandGenerator() #    comm_data = cmdgen.CommunityData(securityName, commName)#    transport = cmdgen.UdpTransportTarget((ip, 161))   ##    variables = ((1, 3, 6, 1, 2, 1, 2, 2, 1, 5, 22), Gauge32(250000000))  ##    variables = (cmdgen.MibVariable('SNMPv2-MIB', 'sysName',0),"junzhong")##    variables = (cmdgen.MibVariable('IF-MIB', 'ifSpeed',22), Gauge32(1000000)) #    variables = (1,3,6,1,4,1,9,2,1,55)##    ,'172.25.1.1'#                #.1.3.6.1.4.1.9.2.1.55.172.25.1.1#    errIndication, errStatus, errIndex, result = cg.setCmd(comm_data, transport, variables) #    print errIndication#    print errStatus#    print errStatus.prettyPrint()#    print result        if __name__ == '__main__':#    updateIfSpeed('192.168.11.253', 'jztech', 'jztech')    print getIfSpeed('192.168.11.253', 'jztec', 'jztec')#     getIfSpeed('203.94.0.1', 'hapLink-JZtest', 'hapLink-JZtest')