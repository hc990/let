# -*- coding: utf-8 -*-'''Created on 2012-9-9@author: zongzong'''# Notification Originator Application (TRAP)from pysnmp.carrier.asynsock.dispatch import AsynsockDispatcherfrom pysnmp.carrier.asynsock.dgram import udpfrom pyasn1.codec.ber import encoderfrom pysnmp.proto import api  from pysnmp.entity.rfc3413.oneliner import cmdgen  from pysnmp.proto import rfc1902from pysnmp.proto.rfc1902 import Gauge32 #/**#Speed   (1, 3, 6, 1, 2, 1, 2, 2, 1, 5)#*/def getIfSpeed(ip, securityName, commName):#    errorIndication, errorStatus, errorIndex, varBinds = cmdgen.CommandGenerator().getCmd(#    cmdgen.CommunityData(securityName, commName , 1),##    cmdgen.UdpTransportTarget((ip, 161)),cmdgen.MibVariable('IF-MIB', 'ifSpeed',22))#    cmdgen.UdpTransportTarget((ip, 161)),(1,3,6,1,4,1,9,2,1,55))##    cmdgen.UdpTransportTarget((ip, 161)),(1,3,6,1,2,1,14,1,17,22,))##    cmdgen.UdpTransportTarget((ip, 161)),cmdgen.MibVariable('SNMPv2-MIB', 'sysName',0))#    #无用 (1.3.6.1.2.1.2.2.1.5)##    (1, 3, 6, 1, 2, 1, 2, 2, 1, 5, 22) #    if errorStatus:#        print '%s at %s\n' % (errorStatus.prettyPrint(), errorIndex and varBinds[-1][int(errorIndex) - 1] or '?')    #    print(errorIndication)#    print(errorStatus)#    print(varBinds)def updateIfSpeed(ip, securityName, commName):      cg = cmdgen.CommandGenerator()     comm_data = cmdgen.CommunityData(securityName, commName)    transport = cmdgen.UdpTransportTarget((ip, 161))   #    variables = ((1, 3, 6, 1, 2, 1, 2, 2, 1, 5, 22), Gauge32(250000000))  #    variables = (cmdgen.MibVariable('SNMPv2-MIB', 'sysName',0),"junzhong")#    variables = (cmdgen.MibVariable('IF-MIB', 'ifSpeed',22), Gauge32(1000000))     variables = (1,3,6,1,2,1,14,1,17,22,0),Gauge32(1000000)      errIndication, errStatus, errIndex, result = cg.setCmd(comm_data, transport, variables)     print errIndication    print errStatus    print errStatus.prettyPrint()    print result            if __name__ == '__main__':#    updateIfSpeed('192.168.11.253', 'jztech', 'jztech')    getIfSpeed('192.168.11.253', 'jztec', 'jztec')#     getIfSpeed('203.94.0.1', 'hapLink-JZtest', 'hapLink-JZtest')